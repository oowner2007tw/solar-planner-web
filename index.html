<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Solar PV 太陽光電專案管理系統</title>
    <!-- 引入 FontAwesome 圖示庫 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- 引入 Chart.js 圖表庫 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --primary-color: #0f4c75; /* 深藍：專業科技感 */
            --secondary-color: #3282b8;
            --accent-color: #bbe1fa;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --bg-color: #f4f6f9;
            --sidebar-width: 250px;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Microsoft JhengHei', 'Segoe UI', sans-serif;
        }

        body {
            background-color: var(--bg-color);
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: var(--sidebar-width);
            background-color: var(--primary-color);
            color: white;
            display: flex;
            flex-direction: column;
            position: fixed;
            height: 100%;
            transition: 0.3s;
            z-index: 100;
        }

        .logo {
            padding: 20px;
            font-size: 20px;
            font-weight: bold;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .logo i {
            color: var(--warning-color);
            margin-right: 10px;
        }

        .menu {
            list-style: none;
            padding-top: 20px;
        }

        .menu li {
            padding: 15px 25px;
            cursor: pointer;
            transition: 0.2s;
            display: flex;
            align-items: center;
        }

        .menu li i {
            width: 30px;
            text-align: center;
            margin-right: 10px;
        }

        .menu li:hover, .menu li.active {
            background-color: var(--secondary-color);
            border-left: 5px solid var(--accent-color);
        }

        /* Main Content */
        .main-content {
            margin-left: var(--sidebar-width);
            flex: 1;
            padding: 20px;
            width: calc(100% - var(--sidebar-width));
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            margin-bottom: 25px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Dashboard Cards */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 20px;
            margin-bottom: 25px;
        }

        .card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
            position: relative;
            overflow: hidden;
        }

        .card h3 {
            font-size: 14px;
            color: #666;
            margin-bottom: 10px;
        }

        .card .value {
            font-size: 28px;
            font-weight: bold;
            color: var(--primary-color);
        }

        .card i {
            position: absolute;
            right: 20px;
            bottom: 20px;
            font-size: 40px;
            opacity: 0.1;
        }

        /* Charts Section */
        .charts-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 25px;
        }

        .chart-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        /* Table Styles */
        .table-container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }

        th, td {
            text-align: left;
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        th {
            background-color: #f8f9fa;
            color: #444;
        }

        .status-badge {
            padding: 5px 10px;
            border-radius: 15px;
            font-size: 12px;
            font-weight: bold;
        }

        .status-ok { background-color: #d4edda; color: #155724; }
        .status-warn { background-color: #fff3cd; color: #856404; }
        .status-error { background-color: #f8d7da; color: #721c24; }

        /* Workflow Visual */
        .workflow-step {
            display: flex;
            align-items: center;
            margin: 20px 0;
        }
        .step {
            flex: 1;
            text-align: center;
            position: relative;
        }
        .step::after {
            content: '';
            position: absolute;
            width: 100%;
            height: 3px;
            background: #ddd;
            top: 15px;
            left: 50%;
            z-index: 0;
        }
        .step:last-child::after { display: none; }
        .step-circle {
            width: 30px;
            height: 30px;
            background: #ddd;
            border-radius: 50%;
            margin: 0 auto 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 1;
            color: white;
        }
        .step.active .step-circle { background: var(--success-color); }
        .step.active::after { background: var(--success-color); }

        /* View Switching Logic */
        .view-section { display: none; }
        .view-section.active { display: block; }
        
        .btn {
            padding: 8px 15px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 5px;
        }
        .btn-primary { background: var(--primary-color); color: white; }
        .btn-outline { border: 1px solid #ccc; background: white; }

    </style>
</head>
<body>

    <!-- Sidebar Menu -->
    <nav class="sidebar">
        <div class="logo"><i class="fas fa-solar-panel"></i> 太陽光電管理系統</div>
        <ul class="menu">
            <li class="active" onclick="switchView('dashboard', this)"><i class="fas fa-chart-line"></i> 總覽儀表板</li>
            <li onclick="switchView('crm', this)"><i class="fas fa-handshake"></i> 業務開發 (CRM)</li>
            <li onclick="switchView('permitting', this)"><i class="fas fa-file-contract"></i> 行政送件流程</li>
            <li onclick="switchView('engineering', this)"><i class="fas fa-hard-hat"></i> 工程與施工</li>
            <li onclick="switchView('om', this)"><i class="fas fa-wrench"></i> 維運監控 (O&M)</li>
            <li onclick="switchView('finance', this)"><i class="fas fa-calculator"></i> 財務成本</li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <header class="header">
            <h2 id="page-title">總覽儀表板 (Executive Dashboard)</h2>
            <div class="user-info">
                <span>Admin User</span>
                <i class="fas fa-user-circle fa-lg"></i>
            </div>
        </header>

        <!-- VIEW 1: Dashboard -->
        <section id="dashboard" class="view-section active">
            <div class="cards-grid">
                <div class="card">
                    <h3>總建置容量</h3>
                    <div class="value">12.5 MW</div>
                    <i class="fas fa-bolt"></i>
                </div>
                <div class="card">
                    <h3>本月預估發電</h3>
                    <div class="value">1.2 GWh</div>
                    <i class="fas fa-chart-bar"></i>
                </div>
                <div class="card">
                    <h3>進行中案件</h3>
                    <div class="value">24 案</div>
                    <i class="fas fa-project-diagram"></i>
                </div>
                <div class="card">
                    <h3>異常警示</h3>
                    <div class="value" style="color: var(--danger-color);">3 件</div>
                    <i class="fas fa-exclamation-triangle"></i>
                </div>
            </div>

            <div class="charts-container">
                <div class="chart-box">
                    <h3>即時發電功率 (kW) - 全場域</h3>
                    <canvas id="powerChart"></canvas>
                </div>
                <div class="chart-box">
                    <h3>案件階段分佈</h3>
                    <canvas id="statusChart"></canvas>
                </div>
            </div>

            <div class="table-container">
                <h3>待辦事項總覽</h3>
                <table>
                    <thead>
                        <tr>
                            <th>優先級</th>
                            <th>事項內容</th>
                            <th>案場名稱</th>
                            <th>截止日期</th>
                            <th>操作</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="status-badge status-error">緊急</span></td>
                            <td>Inverter 03 斷線異常</td>
                            <td>彰化 A 廠區</td>
                            <td>今日</td>
                            <td><button class="btn btn-primary">派工</button></td>
                        </tr>
                        <tr>
                            <td><span class="status-badge status-warn">高</span></td>
                            <td>能源局同意備案補件</td>
                            <td>台南 B 農棚</td>
                            <td>2023/12/20</td>
                            <td><button class="btn btn-outline">查看</button></td>
                        </tr>
                        <tr>
                            <td><span class="status-badge status-ok">一般</span></td>
                            <td>Q4 維運報告生成</td>
                            <td>高雄 C 屋頂</td>
                            <td>2023/12/31</td>
                            <td><button class="btn btn-outline">下載</button></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- VIEW 2: Permitting (Workflow) -->
        <section id="permitting" class="view-section">
            <div class="table-container">
                <h3>案件送件進度追蹤</h3>
                <div style="margin: 20px 0; padding: 20px; background: #fafafa; border: 1px solid #ddd; border-radius: 8px;">
                    <h4><i class="fas fa-search"></i> 案件詳情：台南 B 農棚 (200kW)</h4>
                    <div class="workflow-step">
                        <div class="step active"><div class="step-circle"><i class="fas fa-check"></i></div><small>併聯審查</small></div>
                        <div class="step active"><div class="step-circle"><i class="fas fa-check"></i></div><small>同意備案</small></div>
                        <div class="step active"><div class="step-circle"><i class="fas fa-pen"></i></div><small>施工許可</small></div>
                        <div class="step"><div class="step-circle">4</div><small>完工掛表</small></div>
                        <div class="step"><div class="step-circle">5</div><small>設備登記</small></div>
                    </div>
                    <p><strong>目前狀態：</strong> <span class="status-badge status-warn">等待建照核發</span></p>
                    <p><strong>預警：</strong> 施工許可申請已超過 14 天未回覆。</p>
                </div>

                <table>
                    <thead>
                        <tr>
                            <th>案場代號</th>
                            <th>案場名稱</th>
                            <th>容量</th>
                            <th>目前階段</th>
                            <th>承辦人</th>
                            <th>進度</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>PV-23001</td>
                            <td>台南 B 農棚</td>
                            <td>199 kW</td>
                            <td>施工許可申請中</td>
                            <td>王小明</td>
                            <td>
                                <div style="background:#ddd; height:6px; width:100px; border-radius:3px;">
                                    <div style="background:var(--secondary-color); height:6px; width:60%; border-radius:3px;"></div>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td>PV-23005</td>
                            <td>桃園工廠屋頂</td>
                            <td>499 kW</td>
                            <td>併聯審查核准</td>
                            <td>李大華</td>
                            <td>
                                <div style="background:#ddd; height:6px; width:100px; border-radius:3px;">
                                    <div style="background:var(--success-color); height:6px; width:30%; border-radius:3px;"></div>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- VIEW 3: Engineering -->
        <section id="engineering" class="view-section">
             <div class="cards-grid">
                <div class="card">
                    <h3>施工中案場</h3>
                    <div class="value">5</div>
                </div>
                <div class="card">
                    <h3>今日出工人數</h3>
                    <div class="value">32 人</div>
                </div>
            </div>
            <div class="table-container">
                <h3><i class="fas fa-camera"></i> 施工日誌與物料管理</h3>
                <br>
                <button class="btn btn-primary"><i class="fas fa-plus"></i> 新增日誌</button>
                <button class="btn btn-outline">庫存查詢</button>
                <table>
                    <thead>
                        <tr>
                            <th>日期</th>
                            <th>案場</th>
                            <th>工程項目</th>
                            <th>施工內容</th>
                            <th>照片</th>
                            <th>狀態</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>2023/12/14</td>
                            <td>台中 D 停車場</td>
                            <td>模組鋪設</td>
                            <td>完成 A 區模組安裝 120 片，鎖附扭力檢查完成。</td>
                            <td><i class="fas fa-image" style="color:blue; cursor:pointer;"></i> (3)</td>
                            <td><span class="status-badge status-ok">正常</span></td>
                        </tr>
                        <tr>
                            <td>2023/12/14</td>
                            <td>彰化 A 廠區</td>
                            <td>機電工程</td>
                            <td>AC 盤體定位，拉線作業。</td>
                            <td><i class="fas fa-image" style="color:blue; cursor:pointer;"></i> (5)</td>
                            <td><span class="status-badge status-ok">正常</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Placeholder Views for demo -->
        <section id="crm" class="view-section">
            <div class="table-container">
                <h3>業務機會清單 (CRM)</h3>
                <p>此處顯示潛在客戶漏斗與 ROI 試算工具...</p>
            </div>
        </section>
        
        <section id="om" class="view-section">
            <div class="table-container">
                <h3>維運監控中心 (O&M)</h3>
                <div style="display:flex; gap:10px; margin-bottom:15px;">
                    <div style="padding:10px; background:#d4edda; border-radius:5px;">正常運作：125 台</div>
                    <div style="padding:10px; background:#f8d7da; border-radius:5px;">異常告警：2 台</div>
                    <div style="padding:10px; background:#fff3cd; border-radius:5px;">通訊中斷：1 台</div>
                </div>
                <p>此處串接 Inverter API 顯示 PR 值與發電曲線...</p>
            </div>
        </section>

        <section id="finance" class="view-section">
            <div class="table-container">
                <h3>財務損益表</h3>
                <p>此處顯示各案場 預算 vs 實際支出 與 台電售電收入對帳...</p>
            </div>
        </section>

    </main>

    <script>
        // 切換頁面功能
        function switchView(viewId, element) {
            // 隱藏所有區塊
            document.querySelectorAll('.view-section').forEach(el => {
                el.classList.remove('active');
            });
            // 顯示目標區塊
            document.getElementById(viewId).classList.add('active');

            // 處理選單 Active 狀態
            document.querySelectorAll('.menu li').forEach(el => {
                el.classList.remove('active');
            });
            element.classList.add('active');

            // 更新標題
            const titles = {
                'dashboard': '總覽儀表板 (Executive Dashboard)',
                'crm': '業務開發與評估 (CRM)',
                'permitting': '行政送件流程管理',
                'engineering': '工程與施工管理',
                'om': '維運監控中心 (O&M)',
                'finance': '財務與成本控管'
            };
            document.getElementById('page-title').innerText = titles[viewId];
        }

        // 初始化圖表 (使用 Chart.js)
        window.onload = function() {
            // 1. 發電功率圖 (Line Chart)
            const ctxPower = document.getElementById('powerChart').getContext('2d');
            new Chart(ctxPower, {
                type: 'line',
                data: {
                    labels: ['06:00', '08:00', '10:00', '12:00', '14:00', '16:00', '18:00'],
                    datasets: [{
                        label: '今日發電 (kW)',
                        data: [0, 150, 800, 1200, 1100, 400, 0],
                        borderColor: '#0f4c75',
                        backgroundColor: 'rgba(15, 76, 117, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'top' }
                    }
                }
            });

            // 2. 案件狀態圓餅圖 (Doughnut Chart)
            const ctxStatus = document.getElementById('statusChart').getContext('2d');
            new Chart(ctxStatus, {
                type: 'doughnut',
                data: {
                    labels: ['開發中', '送件中', '施工中', '運轉中'],
                    datasets: [{
                        data: [10, 15, 5, 20],
                        backgroundColor: [
                            '#bbe1fa',
                            '#ffc107',
                            '#3282b8',
                            '#28a745'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: { position: 'bottom' }
                    }
                }
            });
        };
    </script>
</body>
</html>
